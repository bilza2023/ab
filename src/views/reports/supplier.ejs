<!DOCTYPE html>
<html>
<head>
  <title><%= report.meta.title %></title>
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/css/reports.css" />
</head>

<body>

  <%- include('../partials/nav') %>

  <div class="report-container">

    <div class="report-title">
      <%= report.meta.title %>
    </div>

    <div class="report-meta">
      Generated at: <%= report.meta.generatedAt %>
    </div>

    <div class="kpis">
      <div class="kpi-box">
        <div class="kpi-label">Total Suppliers</div>
        <div class="kpi-value"><%= report.kpis.totalSuppliers %></div>
      </div>
    </div>

    <% if (!report.sections || report.sections.length === 0) { %>

      <div class="report-card">
        <div class="empty-row">No supplier deliveries found.</div>
      </div>

    <% } else { %>

      <% report.sections.forEach(section => { %>

        <div class="report-card">

          <div class="mma-header">
            <div class="mma-title">
              Supplier: <%= section.supplierId %>
            </div>
            <div class="mma-stats">
              Total Delivered:
              <strong><%= section.totalDelivered %></strong>
            </div>
          </div>

          <table>
            <thead>
              <tr>
                <th>Timestamp</th>
                <th>MMA</th>
                <th>Shade</th>
                <th>Size</th>
                <th class="text-right">Qty</th>
              </tr>
            </thead>

            <tbody>

              <% if (!section.deliveries || section.deliveries.length === 0) { %>
                <tr>
                  <td colspan="5" class="empty-row">No deliveries</td>
                </tr>
              <% } else { %>

                <% section.deliveries.forEach(delivery => { %>
                  <tr>
                    <td><%= delivery.ts %></td>
                    <td><%= delivery.mmaCode %></td>
                    <td><%= delivery.shade %></td>
                    <td><%= delivery.size %></td>
                    <td class="text-right text-warning"><%= delivery.qty %></td>
                  </tr>
                <% }) %>

              <% } %>

            </tbody>
          </table>

        </div>

      <% }) %>

    <% } %>

  </div>

</body>
</html>