<!DOCTYPE html>
<html>
<head>
  <title><%= report.meta.title %></title>
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/css/reports.css" />
</head>

<body>

  <%- include('../partials/nav') %>

  <div class="report-container">

    <div class="report-title">
      <%= report.meta.title %>
    </div>

    <div class="report-meta">
      Generated at: <%= report.meta.generatedAt %>
    </div>

    <div class="kpis">
      <div class="kpi-box">
        <div class="kpi-label">Total MMAs</div>
        <div class="kpi-value"><%= report.kpis.totalMmas %></div>
      </div>
    </div>

    <% if (report.sections.length === 0) { %>

      <div class="mma-card">
        <div class="empty-row">No stock data available.</div>
      </div>

    <% } else { %>

      <% report.sections.forEach(section => { %>

        <div class="mma-card">

          <div class="mma-header">
            <div class="mma-title"><%= section.mmaCode %></div>
            <div class="mma-stats">
              Total Qty: <strong><%= section.totalQty %></strong> |
              Slots: <strong><%= section.totalSlots %></strong>
            </div>
          </div>

          <table>
            <thead>
              <tr>
                <th>Supplier</th>
                <th>Shade</th>
                <th>Size</th>
                <th class="text-right">Qty</th>
              </tr>
            </thead>

            <tbody>

              <% if (section.slots.length === 0) { %>
                <tr>
                  <td colspan="4" class="empty-row">No active slots</td>
                </tr>
              <% } else { %>
                <% section.slots.forEach(slot => { %>
                  <tr>
                    <td><%= slot.supplierId %></td>
                    <td><%= slot.shade %></td>
                    <td><%= slot.size %></td>
                    <td class="text-right text-warning"><%= slot.qty %></td>
                  </tr>
                <% }) %>
              <% } %>

            </tbody>
          </table>

        </div>

      <% }) %>

    <% } %>

  </div>

</body>
</html>