<!DOCTYPE html>
<html>
<head>
  <title><%= report.meta.title %></title>
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="/css/reports.css" />
</head>

<body>

  <%- include('../partials/nav') %>

  <div class="report-container">

    <div class="report-card">

      <div class="report-title">
        <%= report.meta.title %>
      </div>

      <div class="report-meta">
        Generated at: <%= report.meta.generatedAt %>
      </div>

      <div class="kpis">
        <div class="kpi-box">
          <div class="kpi-label">Total Transports</div>
          <div class="kpi-value"><%= report.kpis.totalTransports %></div>
        </div>

        <div class="kpi-box">
          <div class="kpi-label">Mismatches</div>
          <div class="kpi-value"><%= report.kpis.mismatches %></div>
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <% report.table.columns.forEach(col => { %>
              <th><%= col.label %></th>
            <% }) %>
          </tr>
        </thead>

        <tbody>
          <% if (report.table.rows.length === 0) { %>
            <tr>
              <td colspan="<%= report.table.columns.length %>" class="empty-row">
                No transport records found.
              </td>
            </tr>
          <% } else { %>

            <% report.table.rows.forEach(row => { %>

              <tr class="
                <%= row.status === 'MISMATCH' ? 'row-mismatch' : '' %>
                <%= row.status === 'CANCELLED' ? 'row-cancelled' : '' %>
              ">

                <% report.table.columns.forEach((col, idx) => { %>

                  <% if (col.key === 'status') { %>
                    <td>
                      <span class="status-badge status-<%= row.status %>">
                        <%= row.status %>
                      </span>
                    </td>
                  <% } else { %>
                    <td class="<%= idx === 4 ? 'text-warning text-right' : '' %>">
                      <%= row[col.key] %>
                    </td>
                  <% } %>

                <% }) %>

              </tr>

            <% }) %>

          <% } %>
        </tbody>
      </table>

    </div>

  </div>

</body>
</html>